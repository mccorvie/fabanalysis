---
title: "TSMC Fab Capacity"
author: "Ryan McCorvie"
format:
  html:
    toc: true
    toc-location: left
    sidebar: true
    theme: cosmo
    include-after-body: googletag.html
editor: visual
---

```{r}
#| echo: false
#| output: false
#| warning: false

library( tidyverse )
source( "common.R")

```

## Overview

This research project describes some methods to get rough estimates of the chip production capacity of TSMC on the most advanced nodes, primarily the advanced 5nm and 3nm nodes.  These are the nodes used for the most advanced chips, including Apple silicon and NVidia's most advanced HPC GPU's.  Using official statements from TSMC, industry media reports and open source intelligence (OSINT) we describe several methodologies to triangulate these quantities.

The ultimate goal of this project is to quantify global chip fabrication capacity. Chips are an essential input for AI, so chip fabrication capacity is one way to understand the limits on AI scaling.  
However, the bulk of the chips used in AI are currently manufactured by NVidia, and NVidia uses TSMC as their primary fab for manufacturing the chips.  Google and AMD also use TSMC as their primary fab for their own TPU's and GPU's.   

This project describes three approaches.  First using TSMC's earnings reports and public information about wafer pricing, we estimate TSMC's actual production by node.  Second, using ASML's earnings reports, we estimate which global fabs possess the most advanced lithography scanners.  Using the specifications listed for ASML's product lines, we estimate capacity.  Finally, using satellite imagery and industry reports, we estimate the energy usage of two of TSMC's advanced fabs, and use this to estimate production capacity.

### Commercially Available Supply Chain Analysis

Given the importany role that semiconductors play in industry, and the growing importance of AI, there are a number of organizations and analysts who sell research reports estimating all aspects of the semiconductor supply chain. This includes sector analysts at investment banks and buy-side investment firms, as well as industry consultants.  Undoubtedly the techniques described in this research project are not novel, but they are open source depending only on publically available information and they are replicable.  

This project encompassed approximately 70 hours of chatbot assisted research.  However, the author is not a professional supply chain expert.  Undoubtedly some of the commercially available research is deeper, more comprehensive and may have access to sources which are private or which I was unable to locate.  For the most part, commercially available research may not be publically republished.

Here is a list of some firms which sell similar kinds of supply chain analysis:

-   [SEMI](https://www.semi.org/en) is the non-for-profit industry trade group for the semiconductor industry. One of their flagship products is the [fab forecast](https://www.semi.org/en/products-services/market-data/fab-forecast).
-   [Knometa](https://knometa.com/services/reports/) also publishes research reports on manufacturing capacity, though their final report was in 2024
-   [Tech Insights](https://www.techinsights.com/) publishes reports on many aspects of the semiconductor supply chain
-   [Counterpoint Research](https://counterpointresearch.com/en) is another semiconductor supply chain research firm

### Quantifying Wafer Production

The industry standard production unit is "wafers per month", where a wafer is a thin silicon disc which is etched with of many individual chips. There are other stages of chip production which involve cutting the wafer into individual chips and packaging the chips on circuit boards. Historically the industry used a wafter with a 200mm (\~8") diameter, but modern nodes are etched on 300mm (\~12") diameter chips. When comparing production across nodes, usually a 300mm equivalent wafer is used. Since all the advanced nodes use 300mm, this is less relevant.

In the search to continue scaling chip power at Moore's law, increasingly elaborate engineering techniques have been developed.  The most advanced chips use a methodology called Extreme Ultraviolet (EUV) lithography, where a laser vaporizes a droplet of tin, and the plasma emits light at 13.5nm frequency.  The laser is reflected through a reticle with a mask, then focused on the silicon.  The wafer is covered in photoresist which reacts when exposed to light.  Subsequent stages remove the photo resist and etch the silicon in the patterns from the mask.  For modern nodes, the same wafer is rescanned many times with different patterns to etch a three dimensional pattern on the silicon.

Different generations of technology are roughly grouped in to "nodes".  The nodes originally represented a physical property of the size of the patterns etched into silicon, but this is no longer the case.  For marketing reasons, these nodes are generally related to a physical measurement.  The most advanced high-production nodes are currently 5nm and 3nm, though research is being conducted into 2nm and 1.7 angstron nodes.  Different firms use different marketing terms, and nodes are not always directly comparable between firms.  Moreover, firms distinguish their manufacturing process with additional modifiers, so you will see nodes described as "N7+" or "N3E" where the "E" stands for "enhanced".  In this research note, for lack of more finely grained data, we will elide these distinctions and use node labels like "7nm", "5nm" and "3nm".

![wafer](images/gleemingwafer.jpg)


### Production Capacity Reported by TSMC

TSMC does not directly report production capacity in fine detail, such as at the fab or node level. However, the official sources do provide some high-level statistics which anchor this analysis.

-   At the end of 2024, across 4 GIGAFAB facilities (fab 12, fab 14, fab 15 and fab 18) which comprise the substantial majority of advanced node manufacturing, TSMC reports an annual capacity of 12.74 million 300mm wafers capacity (1,061 kwpm) [source](https://www.tsmc.com/english/dedicatedFoundry/manufacturing/gigafab)

-   Annual capacity of the manufacturing facilities managed by TSMC and its subsidiaries approximately 17 million 12-inch equivalent wafers in 2024 (\~1,400 kwpm). [source](https://www.tsmc.com/english/dedicatedFoundry/manufacturing/gigafab)

The [2024 annual report](https://investor.tsmc.com/static/annualReports/2024/english/index.html) states that total wafer shipments were 12.9 million 12-inch equivalent wafers as compared to 12.0 million 12-inch equivalent wafers in 2023. This implies a utilization rate of \~75%.

Furthermore it states the total annual capacity is:

::: {.center .small style="width: 60%;"}
|Year|Capacity|
|---|------|
| 2023 | 16-17 million |
| 2024 | 16-17 million |
| 2025 | 17-18 million |
:::

## TSMC Wafer Production

```{r}
#| echo: false
#| output: false

source( "TSMC shipments.R")
```

As a lower bound for production capacity, we seek to estimate the actual production.  Understanding actual shipments is also useful for quantifying the AI capacity of firms farther down the supply chain.  Our approach is to use quarterly earnings statements published by TSMC for investors.  In order to translate revenues to wafer shipments, we devise a model to estimate the average sales price (ASP) of various production nodes.


### Results

Last things first and cutting to the chase, here are the results of the model.  We show the the estimated production numbers using this model.  In subsequent sections we will discuss the various methodologies and assumptions which comprise this approach.

Here are estimates of TSMC wafer production by node over the past 10 years.

```{r}
#| echo: false

filter( tsmc_wafer_production, Node %in% c( "3nm", "5nm","7nm","10nm")) |> datify() |> 
  ggplot( aes( x=Date, y=kWPM, fill = Node) ) + geom_col() + scale_fill_brewer(palette= "Set3") + theme_minimal() + labs(title= "Estimated Wafer Production")

```


### TSMC quarterly reports and revenue attribution


TSMC publishes total wafer production and wafer revenues figures broken out by node type in its [quarterly earnings reports](https://investor.tsmc.com/english/quarterly-results/2025/q4). TSMC also publishes the total number of wafers sold, so this aggregate be used to triangulate the wafers in each category. This information is available quarterly going back 9 years or so.

If one knows the average sales price (ASP) for wafers in each category, then one could infer the number of wafers sold.

![TSMC revenue breakdown](images/rev-breakdown.png){width="60%"}

![TSMC quarterly report](images/tsmc_rev.png){width="60%"}

### Average Sales Price (ASP) of wafers

There are several publicly available sources which provide estimates of average wafer prices. It's reasonable to suppose that wafer prices are individually negotiated by each customer and depended on many details such as the size of the batch, the complexity of the chip, and many other factors. However, for a rough estimate we look only for the *average* sales price.

Note that as a Taiwan-based company, TSMC reports its earnings in Taiwan dollars (TWD). However, as silicon wafers are a global commodity, it's reasonable to assume that prices are more commonly quoted in US dollars, and that the prices in dollars are more stable. Therefore we first convert revenues to dollars.

-   In late 2022, a [report by DigiTimes](https://www.tomshardware.com/news/tsmc-will-charge-20000-per-3nm-wafer?utm_source=chatgpt.com) provided one estimate for ASP by node type
-   A more recent [report by Creative Strategies](https://www.tomshardware.com/tech-industry/tsmcs-wafer-pricing-now-usd18-000-for-a-3nm-wafer-increased-by-over-3x-in-10-years-analyst) is more-or-less in line with that, and corroborates the steep increase in price by node.
-   AnySilicon has a [wafer price explainer](https://anysilicon.com/wafer-cost/) with a curve estimating wafer prices.

Synthesizing these sources, we take the following as the ASP by node

::: {.center .small style="width: 60%;"}
| Node      | ASP (\$k) |
|-----|-----|
| 3nm       | 20        |
| 5nm       | 16        |
| 7nm       | 10        |
| 10nm      | 6         |
| 16nm-20nm | 4         |
| 28nm      | 3         |
| 40nm-90nm | 2.6       |
| 0.1um+    | 2         |
:::

With these prices, derived primarily from the source published in 2022, the total implied wafer production equals the reported wafer production within 5% for all four quarters of 2022. However, these prices underestimate production in earlier periods suggesting ASP's were lower then, and overestimates recent production suggesting ASP's are higher.  In the next section we describe an adjustment for broad price trends, and the adjusted and unadjusted total estimated wafer production is plotted below against the actual reported production.



```{r}
#| echo: false

plotme<- est_total |> pivot_longer( `Total kWPM (Estimate)`:`Actual kWPM`, names_to = "Series", values_to = "kWPM") |> datify() |>
  mutate( width = if_else( Series == "Actual kWPM", 1, 0.5 )) 

ggplot( plotme, aes( x=Date)) +
#  geom_line( aes(y=`Actual kWPM`, linewidth = width), color="darkgrey", size=1)+
  geom_line(data = filter(plotme, Series == "Actual kWPM" ), aes(y=kWPM, color=Series), linewidth=1) +
  geom_line( aes(y=kWPM, color=Series)) +
  theme_minimal() + ylab("kWPM") + labs(title="Total Wafer Output vs Estimate")

```


### Adjusting for broad price trends

TSMC adjusts prices up and down according to demand and costs. It [raised prices](https://www.digitimes.com/news/a20210825PD209.html) by 10% in 2022, and is poised to [raise prices](https://bits-chips.com/article/tsmc-to-raise-advanced-process-prices-by-up-to-10-percent/) [again](https://www.trendforce.com/news/2025/09/05/news-tsmc-to-implement-a-significant-price-hike/?utm_source=chatgpt.com) in 2026. For advanced nodes, TSMC is the major supplier and it therefore has significant pricing power. It has stated that its target is sustained gross margins [above 50%](https://investor.tsmc.com/chinese/encrypt/files/encrypt_file/reports/2025-07/1f4f86c935f1de837672a6973154e64b26bdae57/TSMC%202Q25%20Transcript.pdf).

To account for broad price trends, we incorporate the Beuro of Labor Statistic's Producer Price Index by Industry statistics.  Two series with suggestive names are [PCU33443344](https://fred.stlouisfed.org/series/PCU33443344) for "semiconductor and other electronic component manufacturing" and [PCU334413334413A](https://fred.stlouisfed.org/series/PCU334413334413A) for "other semiconductor devices, including transistors, diodes, and semiconductor parts such as wafers".  Both are plotted below, normalized to Q3 2022, the date of the article estimating ASP's above.  They show broadly similar trends, though the movements are larger for the more specific series ending in 13A.  

```{r}
#| echo: false
pivot_longer( bls_ppi, PCU334413334413A:PCU33443344, names_to = "Index", values_to = "Level") |>
  datify() |>
  ggplot( aes( x=Date, y=Level, color=Index, group=Index ))+ geom_line(linewidth=1)+scale_color_brewer(palette="Set2")+theme_minimal()+labs(title = "Producer Price Index for Semiconductors")

```


We adjust the baseline prices from the DigiTimes report by the PPI.  This adjustment makes the total output estimated from revenues and ASP's better match the actual total output.


```{r}
#| echo: false

ggplot( datify( est_total), aes( x=Date)) +
  geom_segment(
    aes( xend = Date, y = Error, yend = `Error adj`),
    arrow = arrow(length = unit(2, "mm"), type = "closed"),
    color="darkred"
  ) +
  geom_hline(yintercept=0, color="darkgrey") + theme_minimal() + labs(title= "Error Reduction from PPI Adjustment")

```


### Regression analysis

As an additional sanity check for the ASP's, we perform a linear regression of total wafer production against revenues by node.  The regression coefficients should correspond to reciprocal ASP's.  Owing to large error bars, the results are a bit inconclusive, but for the advanced nodes it shows the ASP's used for this analysis aren't wildly off base.

The black points are the ASP's used in this analysis, and the purple.  Its worth noting that some of the error bars for the reciprocal ASP's pass through zero, which implies the error range for the ASP's includes infinity. 

```{r}
#| echo: false
ggplot( ASP_regression, aes( x=Node )) +
  geom_errorbar( aes(y=inv_ASP, ymax = inv_ASP+std, ymin=inv_ASP-std), color="purple") +
  geom_point( aes(y=inv_ASP ), size=0.25,color="purple") +
  geom_point(aes( y=inv_ASP_act), size=2) + theme_minimal() + labs(title="ASP Inferred by Regression") +
  ylab( "1 / ASP")

```


## Capacity Model: Scanner Analysis


```{r}
#| echo: false
#| output: false

source( "ASML IPF.R")
source( "scanners.R")

```


Let us turn now to estimating manufacturing capacity.  In the first of two approaches, we track a critical input to semiconductor manufacturing, lithography scanners.

We first show the results of the model, then discuss the methodology.

### Results

Primarily using ASML earnings reports, we estimate the specific scanner product lines employed by TSMC, and use published specs for each product line to estimate scanner throughput.  

The maroon dots represent actual estimated production.  The purple line is the result of our model.  The grey line is the published model of an industry analyst.


```{r}
#| echo: false

filter( tsmc_capacity1 ) |> datify() |>
  ggplot( aes( x=Date ) ) +
  geom_step( aes( y=`Estimate WPM`), color="purple" )  +
  geom_step( aes( y=`Analyst WPM` ), color="grey50" )  +
  geom_point( data= tsmc_production1, aes( y=kWPM), color="maroon", size=0.5) +
  facet_grid( rows=vars(`Node`)) +
  ggtitle( "TSMC Production Capacity", subtitle = "Scanner Tracker Model") + theme_minimal()+ylab("Estimated kWPM")
```


### Scanner Tracking

There are a number of critical inputs to wafer production: the unprocessed silicon wafers, electricity, water, specialized gasses.  However, one of the rate limiting inputs is the scanner, which uses lasers to imprint the design of the semiconductor on the photoresist.  Modern nodes use extreme ultraviolet (EUV) scanners, and globally there is only one supplier of this technology, the dutch company ASML.  Scanners are discrete units, reletively small in number, and its more tractable to track these units.  They are very expensive equipment, so one may expect that unlike wafers or gas, it's not economical to stockpile scanners which are not in operation. 

The aim of this analysis is to estimate how many ASML scanners for high technology nodes are present in TSMC's fabs.  

### ASML quarterly reports and revenue attribution

While ASML does not report exact which scanners it has sold to which customers, it does provide some granular breakdown of its sales figures in its [quarterly financial reports](https://www.asml.com/en/investors/financial-results/q3-2025). 

In particular, it lists the total unit sales by technology type, and the total sales revenues by technology type, and a regional breakdown of sales revenues.  This simplifies our problem because the major consumer of lithography machines in Taiwan is TSMC.  Its true that TSMC is building fabs in other countries, notably they are building an advanced node fab in Arizona, these projects are nascent.  The bulk of its advanced node production and hence the location of the EUV scanners are in Taiwan.  Conceivably this analysis could also be extended to Samsung, which is the major producer of advanced chips in Korea.  Intel's global fab footprint is trickier to discern, but this analysis could potentially be extended to Intel as well.

Since we have a breakdown of units and revenues by technology type (EUV, ArFi, etc.), we can infer the ASP of each technology type.  What we would like is the joint allocation of units between technology type and region.  However, we only only given the marginal allocation: revenues by region and revenues by product.  

![wafer](images/asml_1q25.png)


### "Raking" the Revenue Allocation

[Iterative Proportional Fitting](https://en.wikipedia.org/wiki/Iterative_proportional_fitting) (IPF) for IPF is a technique for finding a matrix $M$ which is closest in KL-divergence to an initial matrix $P$ and which has specified row sums and column sums.  Because IPF alternately adjusts the output to match the marginals in one dimension and then the other, this technique is sometimes called "raking".  We will use this technique to get a reasonable cross-table of scanners by region and technology type.

We can use $P$ to crudely specify some of the "priors" we know about the allocation of scanners.  If the initial matrix $P$ is the matrix of all 1's, then the results of IPF $M$ are proportional to the independent distribution.  That is, the entries in the table are proportional to the product of the entries on the margins.   If the initial matrix has 0's in some entries, then the result will also have zeros in those entries.  A more principled approach might be to run a full Bayesian program with priors about the allocation of scanners.  However, this technique is straightfoward, easy to implement and gives reasonable results.

We know that owing to [export controls](https://www.asml.com/en/news/press-releases/2024/dutch-governments-updated-export-license-requirement?utm_source=chatgpt.com), EUV machines and some argon flouride immersion (ArFi) scanners are not sold to China.  We also know that TSMC has been an early adopter and large purchaser of EUV scanners.  

Taking these considerations into account, we set the initial matrix to have an relative strength of 0 for EUV scanners in China, Â½ for ArFi scanners in China, 2 for EUV in Taiwan, and 1 for all other entries.

Here is an example of the resulting attribution matrix for one date.  The boxes at the top and the side represent the marginal fraction of revenues for that category as reported directly in the earnings report.  The 6x7 grid in the center is the inferred revenue allocation from IPF using the assumptions embedded in our initial matrix.

```{r}
#| echo: false

date_idx <- 18
quarter <- dimnames( fine_attribution)[[3]][date_idx]
P <- fine_attribution[,,date_idx]
heatmap_with_marginals_onepanel(P,"D",quarter)
```

Here is the revenue allocation of EUV scanners by region over time.

```{r}
#| echo: false

datify(EUV_rev) |>  
   ggplot( aes( x=Date, y=`%`,fill=Region)) +geom_col() + scale_fill_brewer(palette= "Set3") +
   scale_y_continuous(labels = scales::percent)+
   theme_minimal() + labs( title="Allocation of EUV Scanners")

```



### ASP and Unit Allocation

Rather than revenue allocation, we actually wish to know the allocation of scanner units, since this is the critical input for wafer production.  Within a technology category, such as EUV, it could be that some regions purchase more expensive units than other regions, so the allocation of revenues may not be proportional to the allocation of units.  Absent data to quantify these differences, we will assume that units are allocated in proportion with revenues, which implies that all regions have the same ASP within a technology category.



```{r}
#| echo: false
#| warning: false


asml_units_attribution |> datify() |> 
  filter( `Technology` == "EUV") |> 
  ggplot( aes( x=Date, y=`Cum Units`,color=Region)) +geom_line() + geom_point()+ scale_color_brewer(palette= "Set2") + theme_minimal() + labs(title="EUV Units By Region")

asml_units_attribution |> datify() |> 
  filter( `Region` == "Taiwan") |> 
  ggplot( aes( x=Date, y=`Cum Units`,color=`Technology`)) +geom_line() + geom_point()+ scale_color_brewer(palette= "Set2") + theme_minimal() + labs( title="Taiwan Units By Technology Type")

```


We make a further assumption that all scanners delivered to Taiwan are TSMC scanners, and scanners delivered elsewhere are not TSMC scanners.  This is not strictly true, notably TSMC is building a GIGAFAB in Arizona which is starting to come online.   But within the uncertainty of the other assumptions in this model, it's a reasonable starting place for analysis.


At a [2024 Technology Symposium](https://www.theregister.com/2024/11/07/tsmc_highna_euv/?utm_source=chatgpt.com), TSMC announced that they had 10x more EUV scanners in 2023 than in 2019 and that they had 56\% of the global installed base of EUV scanners.  This gibes with the results of our model which implies TSMC had 11 scanners in Q1 2019, and 113 in Q3 2023, and that TSMC scanners were 56\% (113 out of 202) in Q3 2023.

### EUV Scanner Throughput

All of the most advanced nodes use EUV scanners.  However, within the EUV segment there are a [number of different product lines](https://www.asml.com/en/products/euv-lithography-systems), and different models are used to manufacture different nodes.   This represents the current ASML product line, in the recent past they marketed other similar models as well.  TSMC is exploring using EUV High NA technology, but at present its manufacturing process primarily uses conventional EUV scanners.   


From industry reports and product specification pages, we make the following estimates about which scanners are used for which nodes by TSMC.  The relationship between nodes and product lines doesn't exactly match the descriptions on the product specification pages.  Here are some industry reports on the manufacturing process for [7nm ](https://pcper.com/2019/02/tsmc-will-begin-mass-production-of-enhanced-7nm-node-using-euv-in-march-5nm-to-follow/), [5nm](https://fuse.wikichip.org/news/3398/tsmc-details-5-nm/), and [3nm](https://newsletter.semianalysis.com/p/tsmcs-3nm-conundrum-does-it-even) nodes.

::: {.center .small style="width: 60%;"}

|Technology | 2nm | 3nm | 5nm | 7nm | wph | specs |
|-------------|-----|-----|-----|-----|-----|-------|
| NXE:3400C   |     |     |  50%| 50% | 135 | [specs](https://www.asml.com/en/products/euv-lithography-systems/twinscan-nxe-3600d)|
| NXE:3600D   |     | 50% |  50%|     | 160 |[specs](https://www.asml.com/en/products/euv-lithography-systems/twinscan-nxe-3600d)|
| NXE:3800E   |     | 100% |    |     | 220 |[specs](https://www.asml.com/en/products/euv-lithography-systems/twinscan-nxe-3800e) [report](https://en.eeworld.com.cn/news/manufacture/eic513288.html)|
| EXE:5000    | 100% |     |    |     | 185 |[specs](https://www.asml.com/en/products/euv-lithography-systems/twinscan-exe-5000)|
| EXE:5200B   | 50%  |     |    |     | 175 |[specs](https://www.asml.com/en/products/euv-lithography-systems/twinscan-exe-5200b)|
:::

Another factor affecting wafer production rates is the number of layers which are etched onto a given wafer.  More advanced nodes have seen a big increase in the number of times a given wafer is scanned to add additional layers.  The number of layers depends on the particular semiconductor being produced and is not universal to a node.  Some sources distinguish manufacturing processes into even more categories, like "N3" as compared with "N3E".  But the trend toward increasing numbers of scans for advanced nodes is an important factor in manufacturing capacity.

::: {.center .small style="width: 60%;"}
| Node | Layers | Source |
|------|--------|--------|
|  7nm |  4     | [Tom's](https://www.tomshardware.com/news/tsmc-euv-tools-order/) |
| 5nm  | 12     | [wikichip](https://fuse.wikichip.org/news/3398/tsmc-details-5-nm/) |
| 3nm  | 22     | [semianalysis](https://newsletter.semianalysis.com/p/tsmcs-3nm-conundrum-does-it-even) |
| 2nm  | 25     | [Tom's](https://www.tomshardware.com/news/asml-and-tsmc-reveal-more-details-about-3nm-process-technology) |
:::

There is one final factor used for estimating scanner output, the overall efficiency.  Scanners are not always operating at peak capacity.  This decrease in throughput includes everything from planned and unplanned maintanence, rescans due to defects or overlay failures, time taken to swap reticles, and delays due to other stages in manufacturing.  From industry news and annual reports, we estimate this to be around 80\%.

### Allocating to Product Lines

Previously we estimated the total number of EUV units operated by TSMC.  However, wafer production by node is a function of the number of units of each scanner product model.  Thus we need a way to estimate which types of scanners were purchased within the EUV segment.

One clue is to look at trends in ASP over time.  The ASP for the EUV line has increased almost 2.5x over the time period.   On some [calls with investment analysts](https://ourbrand.asml.com/m/77efabb190347295/original/ASML-Transcript-Q1-2025.pdf) after earnings reports, ASML management will discuss how the product mix is affecting the ASP.  

Direct reports of ASP's over time are difficult to come by, but we use the change in ASP's to allocate EUV units to specific product lines.

```{r}
#| echo: false

ASP_by_product |> datify() |> ggplot( aes( x=Date,y=ASP, color=`Technology`)) + geom_line() + theme_minimal() +ylab("ASP ($ millions)")+ labs( title = "ASML Product Average Sales Price") 

```



::: {.center .small style="width: 60%;"}

|Model     | Price  | source |
|----------|--------|--------|
|NXE:3400C | $120mm  |  [wikichip](https://fuse.wikichip.org/news/3250/asml-q4-nxe3400c-machines-ramp-strong-growth-due-to-euv-in-2020/?utm_source=chatgpt.com) |
|NXE:3600D | $160mm  | [reuters](https://www.reuters.com/technology/computer-chip-giant-asml-places-big-bets-tiny-future-2022-05-20/?utm_source=chatgpt.com),  [ft](https://www.ft.com/content/793bcae2-509b-4287-a4da-97e0c86ee87d?utm_source=chatgpt.com)|
|NXE:3800E | $230mm  |[earnings call](https://ourbrand.asml.com/m/77efabb190347295/original/ASML-Transcript-Q1-2025.pdf) |
|EXE:5000  | $350mm  |[reuters](https://www.reuters.com/technology/asmls-next-chip-challenge-rollout-its-new-350-mln-high-na-euv-machine-2024-02-09)|
|EXE:5200B | $350mm  |[reuters](https://www.reuters.com/technology/asmls-next-chip-challenge-rollout-its-new-350-mln-high-na-euv-machine-2024-02-09)|
:::

 This is all very approximate, as there is a lot of sources of uncertainty.  To list a few
 
- Public reports about scanner prices are sketchy and approximate and rarely mention specific models
- Product lines and their prices have changed over time
- The ASP's for TSMC are likely higher than the overall reported ASP as they are early adopters of scanner technology

That said this gives a rough and ready estimate of which specific scanners are available.

Using [Nadaraya-Watson kernel regression](https://en.wikipedia.org/wiki/Kernel_regression) we can decompose the ASP to provide weights to each product line using the above price points.  Linearly interpolating between neighboring price points gives very similar results, but kernel regression is a bit smoother.  The allocation to specific models is shown below.  This the transitions between scanner product lines roughly correspond to published reports about the adoption of 5nm and 3nm.


```{r}
#| echo: false

scanner_model_allocation |> pivot_longer( `EXE:5200B`:`NXE:3400C`, names_to = "Product line", values_to = "%") |> 
  datify() |> 
  ggplot( aes( x=Date, y=`%`, fill=`Product line`)) + geom_col() + scale_fill_brewer(palette="Set3") +
   scale_y_continuous(labels = scales::percent)+
  theme_minimal() + labs(title="Scanner Product Line Allocation")

```


## Capacity Model: Energy and Construciton Analysis
```{r}
#| echo: false
#| output: false

source( "energy.R")

```
Here we take a different approach, and track the actual construction of fabs, and try to estimate the production capacity of each one.

### Results

```{r}
#| echo: false
#| warning: false


tsmc_capacity2 |> datify() |> 
  ggplot( aes( x=Date ) ) + 
  geom_step( aes( y=`Estimate WPM`), color="purple" )  + 
  geom_step( aes( y=`Analyst WPM` ), color="grey50" )  + 
  geom_point( data=tsmc_production2, aes( y=kWPM), color="maroon", size=0.5) +
  facet_grid( rows=vars(`Node`)) + theme_minimal()+
  ggtitle( "TSMC Production Capacity", subtitle = "Energy Construction Model")

``` 
### TSMC Global Fabs

From company announcements and press reports, its possible to identify which nodes are produced at which fabs.  For 3nm and 5nm production capacity, we need to only to focus on Fab 18 in Tainan TW and Fab 21 in Phoenix AZ.  The Arizona fab is just now coming online, so mostly we need to analyze Tainan.

|Location | Fab Name | Nodes | Scanner Model | Source |
|---------|----------|-------|--------|----|
|Tainan (STSP)|Fab 18 (GIGAFAB)|3nm, 5nm| NXE:3600D | [TSMC1](https://pr.tsmc.com/english/news/2986), [TSMC2](https://www.tsmc.com/english/dedicatedFoundry/technology/logic/l_5nm)|
|Taichung (CTSP)|Fab 15 (GIGAFAB)|7nm, 28nm|NXE:3400C/3600D, NXT:2000i/2050i|[TSMC1](https://www.tsmc.com/english/campaign/N7plus), [TSMC2](https://pr.tsmc.com/english/news/2010), [wccftech](https://wccftech.com/tsmc-details-7nm-manufacturing-process-euv/)|
|Phoenix, AZ|Fab 21|5nm|NXE:3600D|[Tom's Hardware](https://www.tomshardware.com/tech-industry/semiconductors/tsmc-gives-an-ultra-rare-video-look-inside-its-fabs-silver-highway-and-fab-tools-revealed-in-flyby-video-of-companys-us-arizona-fab-21)|
|Hsinchu (Baoshan)|Fab 20|2nm| NXE:3800E (?)|[TSMC](https://www.tsmc.com/english/dedicatedFoundry/manufacturing/gigafab)|
|Kaohsiung|Fab 20|2nm| NXE:3800E (?)|[TSMC](https://www.tsmc.com/english/dedicatedFoundry/manufacturing/gigafab)|

### Fab Phase constuction timing

Fab 18 consists of 8 nearly identical buildings, each of which comprises a "phase" of construction and operation.  Its co-located at Hsinchu Science Park in Tainan Taiwan with Fab 14.  Below is a site map of Tainan from 2021 and a recent satellite photo annotated with labels for the construction phases.  

![Tainan map](images/Tainan_site_map.png)

![Tainan satellite photo](images/Tainan_labelled.png)

Here is a satellite photo of the TSMC Arizona site, where phase 1 is complete and phase 2 is under construction.  The shape and dimensions of the buildings are essentially the same as the Tainan fabs.

![Arizona satellite photo](images/TSMC_arizona.png)

Using time-lapse photographs from Google Earth and reports in the press, here is a rough timeline for building construction.  Unfortuantely Google Earth contains large time gaps in its history of Tainan.  A higher quality source of satellite images could refine these estimates.  Its also not entirely possible to tell at what stage of completion or ramp-up a particular fab is in after the exterior structure is completed, but this analysis does provide a lower bound on when a particular fab is operational.

|Fab Name | Location  | Node | Map appearance | Map completion | Reports | Source |
|---|-------|-|--|--|--|--|------|
|Fab 18 P1 | Tainan | 5nm |2/18 |12/19  |1H20 |[media 1](https://cleanroomconnect.com/tsmc-fab-18-facility/)|
|Fab 18 P2 | Tainan | 5nm |5/18 |4/21  |2H20 |[media 1](https://cleanroomconnect.com/tsmc-fab-18-facility/)|
|Fab 18 P3 | Tainan | 5nm |5/18 |4/21  |2H21 |[media 1](https://cleanroomconnect.com/tsmc-fab-18-facility/)|
|Fab 18 P4 | Tainan | 5nm/3nm |4/21 |10/21  |1H22 |[SEMI](https://www.semi.org/en/news-resources/press/Knometa-300mm_wafer_2026_projection), [TSMC p212](https://esg.tsmc.com/download/file/2021_sustainabilityReport/english/e-appendix.pdf)|
|Fab 18 P5 | Tainan | 3nm |4/21 |1/22  |2H22 |[SEMI](https://www.semi.org/en/news-resources/press/Knometa-300mm_wafer_2026_projection)|
|Fab 18 P6 | Tainan | 3nm |4/21 | 3/24 |1H23 |[media 2](https://evertiq.com/news/54173)|
|Fab 18 P7 | Tainan | 3nm |10/21 |3/24 |1H24 |[TSMC](https://esg.tsmc.com/en/update/greenManufacturing/caseStudy/74/index.html)
|Fab 18 P8 | Tainan | 3nm |1/22 |3/24  |2H25 |[media 3](https://knometa.com/news/?post=record-volume-of-ic-wafer-capacity-coming-online-in-2025&utm_source=chatgpt.com)|
|Fab 21 P1 | Phoenix | 5nm |5/21  |2/24 |2H25 |[TSMC](https://www.tsmc.com/static/abouttsmcaz/index.htm)|
|Fab 21 P2 | Phoenix | 3nm |4/22  | |1H28 |[TSMC](https://www.tsmc.com/static/abouttsmcaz/index.htm)|

### Fab Power Analysis

The aim of this section is to estimate the power usage of each fab phase building.  

The energy requirements of a modern fab are substantial.  By [some estimates](https://www.tomshardware.com/tech-industry/semiconductors/tsmc-reduces-peak-power-consumption-of-euv-tools-by-44-percent-company-to-save-190-million-kilowatt-hours-of-electricity-by-2030?utm_source=chatgpt.com), TSMC consumes 9\% of all power in Taiwan.  

Almost all of the electricity consumed by the fab becomes heat which must be dumped to the outside, so the energy of the heat ejected a fab is the same as order of magnitude as the electricity consumed.  According to [Jones 2023](https://ieeexplore.ieee.org/document/10413715) approximately half the energy of a modern fab is used for facilities.  This includes HVAC for filtering and conditioning air for clean rooms, fan motors on cooling towers, compressors, pumps, lighting, and other systems.

Outside of each phase of fab 18 and fab 21 is a large cooling tower.  Below are images of the towers at Fab 21, but the structures at Fab 18 have exactly the same dimensions.  Most of the phases in both sites have 11 towers, though Fab 18P1 has 12.  Depending on fan velocity and weather conditions, each cell could eject between 12-20 MW of heat energy.  Taking mid-range numbers, a tower with 11 cells such as the one pictured could eject ~180MW of energy.  The cooling system itself (fans, pumps and condensers) could consume another 10-20MW.  

Public reports of the [elecrical usage](https://www.aztechcouncil.org/utility-company-makes-progress-on-infrastructure-for-taiwan-semiconductor-project-in-north-phoenix/?utm_source=chatgpt.com) of the Arizona fab phase 1 suggest the fab will consume 200MW of power, scaling to 600MW when further phases are constructed.  This jibes with the estimtes above.

This is all a bit rough, and could undoubtedly be refined, but as a starting point we will assume each phase consumes 200MW of electricity.

![Arizona satellite photo](images/AZ_cooling_satellite.png)

![Arizona street view](images/AZ_cooling_street_view.png)


### Scanner Power Analysis

TSMC does not report exactly which scanners are used, though a [flythrough video](https://www.tomshardware.com/tech-industry/semiconductors/tsmc-gives-an-ultra-rare-video-look-inside-its-fabs-silver-highway-and-fab-tools-revealed-in-flyby-video-of-companys-us-arizona-fab-21) released by TSMC of the interior of Fab 21 shows what are presumed to be NXE:3600D's.  This is one of the machines previously associated to 5nm and 3nm, so this is consistent with the reported production of 5nm semiconductors at Fab 21.


EUV tools are the most energy intensive tool in the fab, but even so they consume only about 11% of the total energy according to [this report](https://www.tomshardware.com/tech-industry/each-euv-chipmaking-tool-consumes-as-much-power-as-a-small-city-euv-fabs-to-consume-54-000-gigawatts-by-2030-more-than-singapore) and [this report](https://www.eenewseurope.com/en/power-is-next-challenge-for-euv-lithography/).  ASML and TSMC are  investing a lot of engineering research into reducing the power needs of scanners as described in [Thijssen et al. 2024](https://ieeexplore.ieee.org/document/10413888) and this [media report](https://www.tomshardware.com/tech-industry/semiconductors/tsmc-reduces-peak-power-consumption-of-euv-tools-by-44-percent-company-to-save-190-million-kilowatt-hours-of-electricity-by-2030?utm_source=chatgpt.com).

We refer to two sources for the power usage of a particular scanner.  The first is from p68 [ASML's 2020 annual report](https://www.annualreports.com/HostedData/AnnualReportArchive/a/NASDAQ_ASML_2020.pdf) which suggests that at 100% untilization, the NXE:3400C uses 1.31MW.  While we don't have exact figures for the NXE:3800D, [Jones 2023](https://ieeexplore.ieee.org/document/10413715) and media reports suggest its about the same accounting for increased complexity of more advanced and increased efficiency of later models.  Note these are all approximations, as the actual energy usage depends on unknown variables such as the dose of light and the number of steps in the manufacturingn process (logic semiconductors have more steps than memory).

So, assuming each phase consumes 200MW of power, scanners account for 11% of that usage, and and each scanner consumes 80% x 1.31MW, eight fab phases at TSMC Fab 18 contain 167 scanners.  This is consistent with the analysis above from ASML earnings reports.  

Using the time series of phase construction, we get the estimate of production capacity in the results section above.


## Conclusions
